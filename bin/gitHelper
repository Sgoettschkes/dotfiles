#!/bin/bash

# File managed by Sgoettschkes/dotfiles
# Do not change

set -o nounset
set -o errexit

readonly Progname=$(basename "$0")
readonly Progdir=$(readlink -m $(dirname "$0"))
readonly Args="$@"

main () {
    local readonly Task=${1:-down}
    local readonly GitTargetBranch=${2:-master}

    local readonly CurrentDir=`pwd`
    local readonly GitBaseDir=`git rev-parse --show-toplevel`

    up () {
        git checkout $GitTargetBranch
        git rebase @{-1}
        git push origin $GitTargetBranch
        git checkout @{-1}
    }

    down () {
        git checkout $GitTargetBranch
        git pull --rebase origin $GitTargetBranch
        git checkout @{-1}
        git rebase $GitTargetBranch
    }

    cd $GitBaseDir
    $Task
    cd $CurrentDir
}
main $Args
